# %% [markdown]
# {{ method_title }}

Generated by MLguide. This notebook is a starter workflow for a **classification** task.

## Problem context
{% if problem_text %}
{{ problem_text }}
{% else %}
_No problem description provided._
{% endif %}

# %% [markdown]
## 1. Imports

# %%
import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.metrics import accuracy_score, classification_report
{% block model_import %}
from sklearn.ensemble import RandomForestClassifier
{% endblock %}

# %% [markdown]
## 2. Load and prepare data

# %%
# TODO: Replace with your real dataset path.
data_path = "data.csv"
target_column = "{{ target_column }}"

df = pd.read_csv(data_path)
X = df.drop(columns=[target_column])
y = df[target_column]

X_train, X_test, y_train, y_test = train_test_split(
    X,
    y,
    test_size=0.2,
    random_state=42,
    stratify=y,
)

# %% [markdown]
## 3. Configure model

# %%
{% block model_init %}
model = RandomForestClassifier(
    n_estimators=200,
    random_state=42,
)
{% endblock %}

# %% [markdown]
## 4. Train and evaluate

# %%
model.fit(X_train, y_train)
y_pred = model.predict(X_test)

acc = accuracy_score(y_test, y_pred)
print(f"Accuracy: {acc:.4f}")
print("\\nClassification report:")
print(classification_report(y_test, y_pred))

# %% [markdown]
## 5. Method notes
{% block method_notes %}
- Tune hyperparameters for your dataset.
- Add cross-validation and feature engineering for production use.
{% endblock %}
